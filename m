Return-Path: <linux-kernel+bounces-737664-lists+linux-kernel=lfdr.de@vger.kernel.org>
X-Original-To: lists+linux-kernel@lfdr.de
Delivered-To: lists+linux-kernel@lfdr.de
Received: from sy.mirrors.kernel.org (sy.mirrors.kernel.org [IPv6:2604:1380:40f1:3f00::1])
	by mail.lfdr.de (Postfix) with ESMTPS id 6979CB0AF11
	for <lists+linux-kernel@lfdr.de>; Sat, 19 Jul 2025 11:17:26 +0200 (CEST)
Received: from smtp.subspace.kernel.org (relay.kernel.org [52.25.139.140])
	(using TLSv1.2 with cipher ECDHE-ECDSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by sy.mirrors.kernel.org (Postfix) with ESMTPS id 26C4D7B7556
	for <lists+linux-kernel@lfdr.de>; Sat, 19 Jul 2025 09:15:58 +0000 (UTC)
Received: from localhost.localdomain (localhost.localdomain [127.0.0.1])
	by smtp.subspace.kernel.org (Postfix) with ESMTP id 608C922FF2E;
	Sat, 19 Jul 2025 09:17:21 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org;
	dkim=pass (1024-bit key) header.d=linux.alibaba.com header.i=@linux.alibaba.com header.b="clQmT50X"
Received: from out30-132.freemail.mail.aliyun.com (out30-132.freemail.mail.aliyun.com [115.124.30.132])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(No client certificate requested)
	by smtp.subspace.kernel.org (Postfix) with ESMTPS id 0F30C21CA14
	for <linux-kernel@vger.kernel.org>; Sat, 19 Jul 2025 09:17:17 +0000 (UTC)
Authentication-Results: smtp.subspace.kernel.org; arc=none smtp.client-ip=115.124.30.132
ARC-Seal:i=1; a=rsa-sha256; d=subspace.kernel.org; s=arc-20240116;
	t=1752916640; cv=none; b=PNHf1IoyJguNv4HWE7RH6Vri3HX0HU7n/vEd5kU4DC+QwTmzGVQ1jIlCZ8sEzIUzR9GwaHVEQSoezB6zCgO+WYdfkyM97S1OrcUFNDYl3xz/F95ydQ5BVvgtiThP/I09m+U3XGcipgfGyUM9Mz0zUITTzRFu7LqYu2J8snErUL0=
ARC-Message-Signature:i=1; a=rsa-sha256; d=subspace.kernel.org;
	s=arc-20240116; t=1752916640; c=relaxed/simple;
	bh=7IlYzhn77dJev2hRKjtozxd0Yq8XgaGAhUfgXTdMQ6Q=;
	h=Date:From:To:Cc:Subject:Message-ID:References:MIME-Version:
	 Content-Type:Content-Disposition:In-Reply-To; b=B8IF5DBTiqNWfsJUgtgsLRlG8+q9ah6D+Lmk0Wc9Ple1zXjxBoB69UFBiWLTEpB42O0SlAaqYeXu2ydjs8VD/IMkQsITON09P/D9iAfTQYnTnylBO9pnuDK03p5Lu1Af4yU/ONlyLQRwwsKUYc45apFeJn6RJxRtaT1tJLAvT/M=
ARC-Authentication-Results:i=1; smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=linux.alibaba.com; spf=pass smtp.mailfrom=linux.alibaba.com; dkim=pass (1024-bit key) header.d=linux.alibaba.com header.i=@linux.alibaba.com header.b=clQmT50X; arc=none smtp.client-ip=115.124.30.132
Authentication-Results: smtp.subspace.kernel.org; dmarc=pass (p=none dis=none) header.from=linux.alibaba.com
Authentication-Results: smtp.subspace.kernel.org; spf=pass smtp.mailfrom=linux.alibaba.com
DKIM-Signature:v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=linux.alibaba.com; s=default;
	t=1752916630; h=Date:From:To:Subject:Message-ID:MIME-Version:Content-Type;
	bh=48j/Fiq/ITVOw3EkwwMwGlaSpdF2iiyoXb+kYVk+eX0=;
	b=clQmT50XrkjVBXRNRwijoVR8H6+Jy50apcc017bjArRIwnAMr7BS53DYCNYAgfBfinqOdhAo8a+IXRMDEOXSzSXuNn5f+i1ph1O+Xt4OXqjg7lUctWv7w0jEYfezkOnvCedVAmbXK9cWmhlQQdl/HZH60MnCkEsCERYpnn3SRng=
Received: from U-V2QX163P-2032.local(mailfrom:fengwei_yin@linux.alibaba.com fp:SMTPD_---0WjEL8b0_1752916629 cluster:ay36)
          by smtp.aliyun-inc.com;
          Sat, 19 Jul 2025 17:17:09 +0800
Date: Sat, 19 Jul 2025 17:17:09 +0800
From: YinFengwei <fengwei_yin@linux.alibaba.com>
To: Kees Cook <kees@kernel.org>
Cc: linux-kernel@vger.kernel.org, linux-mm@kvack.org, 
	zhourundong.zrd@linux.alibaba.com
Subject: Re: [PATCH] binfmt_elf: remove the 4k limitation of program header
 size
Message-ID: <xd6zp5ytq6iakxkqoqqtseomgu5oohau4ynj3xbo7ejohpv7dv@skp2v7awzab4>
References: <20250717110108.55586-1-fengwei_yin@linux.alibaba.com>
 <175279510782.2985357.8915174612817966643.b4-ty@kernel.org>
Precedence: bulk
X-Mailing-List: linux-kernel@vger.kernel.org
List-Id: <linux-kernel.vger.kernel.org>
List-Subscribe: <mailto:linux-kernel+subscribe@vger.kernel.org>
List-Unsubscribe: <mailto:linux-kernel+unsubscribe@vger.kernel.org>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <175279510782.2985357.8915174612817966643.b4-ty@kernel.org>

On Thu, Jul 17, 2025 at 04:31:50PM +0800, Kees Cook wrote:
> On Thu, 17 Jul 2025 19:01:08 +0800, fengwei_yin@linux.alibaba.com wrote:
> > We have assembly code generated by a script. GCC successfully compiles
> > it. However, the kernel cannot load it on an ARM64 platform with a 4K
> > page size. In contrast, the same ELF file loads correctly on the same
> > platform with a 64K page size.
> > 
> > The root cause is the Linux kernel's ELF_MIN_ALIGN limitation on the
> > program headers of ELF files. The ELF file contains 78 program headers
> > (the script inserts many holes when generating the assembly code). On
> > ARM64 with a 4K page size, the ELF_MIN_ALLIGN enforces a maximum of 74
> > program headers, causing the ELF file to fail. However, with a 64K page
> > size, the ELF_MIN_ALIGN is relaxed to over 1,184 program headers, allowing
> > the file to run correctly.
> > 
> > [...]
> 
> Applied to for-next/execve, thanks!
Cook, thanks a lot.

Regards
Yin, Fengwei

> 
> [1/1] binfmt_elf: remove the 4k limitation of program header size
>       https://git.kernel.org/kees/c/8030790477e8
> 
> Take care,
> 
> -- 
> Kees Cook

